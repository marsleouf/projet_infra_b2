function Meteo() {
  this.DataMeteo = {};
  const Mois = [
    "Janvier",
    "Fevrier",
    "Mars",
    "Avril",
    "Mai",
    "Juin",
    "Juillet",
    "Aout",
    "Septembre",
    "Octobre",
    "Novembre",
    "Decembre",
  ];
  const jours = [
    "Dimanche",
    "Lundi",
    "Mardi",
    "Mercredi",
    "Jeudi",
    "Vendredi",
    "Samendi",
  ];
  const WEATHER = {
    0: "Soleil",
    1: "Peu nuageux",
    2: "Ciel voilé",
    3: "Nuageux",
    4: "Très nuageux",
    5: "Couvert",
    6: "Brouillard",
    7: "Brouillard givrant",
    10: "Pluie faible",
    11: "Pluie modérée",
    12: "Pluie forte",
    13: "Pluie faible verglaçante",
    14: "Pluie modérée verglaçante",
    15: "Pluie forte verglaçante",
    16: "Bruine",
    20: "Neige faible",
    21: "Neige modérée",
    22: "Neige forte",
    30: "Pluie et neige mêlées faibles",
    31: "Pluie et neige mêlées modérées",
    32: "Pluie et neige mêlées fortes",
    40: "Averses de pluie locales et faibles",
    41: "Averses de pluie locales",
    42: "Averses locales et fortes",
    43: "Averses de pluie faibles",
    44: "Averses de pluie",
    45: "Averses de pluie fortes",
    46: "Averses de pluie faibles et fréquentes",
    47: "Averses de pluie fréquentes",
    48: "Averses de pluie fortes et fréquentes",
    60: "Averses de neige localisées et faibles",
    61: "Averses de neige localisées",
    62: "Averses de neige localisées et fortes",
    63: "Averses de neige faibles",
    64: "Averses de neige",
    65: "Averses de neige fortes",
    66: "Averses de neige faibles et fréquentes",
    67: "Averses de neige fréquentes",
    68: "Averses de neige fortes et fréquentes",
    70: "Averses de pluie et neige mêlées localisées et faibles",
    71: "Averses de pluie et neige mêlées localisées",
    72: "Averses de pluie et neige mêlées localisées et fortes",
    73: "Averses de pluie et neige mêlées faibles",
    74: "Averses de pluie et neige mêlées",
    75: "Averses de pluie et neige mêlées fortes",
    76: "Averses de pluie et neige mêlées faibles et nombreuses",
    77: "Averses de pluie et neige mêlées fréquentes",
    78: "Averses de pluie et neige mêlées fortes et fréquentes",
    100: "Orages faibles et locaux",
    101: "Orages locaux",
    102: "Orages fort et locaux",
    103: "Orages faibles",
    104: "Orages",
    105: "Orages forts",
    106: "Orages faibles et fréquents",
    107: "Orages fréquents",
    108: "Orages forts et fréquents",
    120: "Orages faibles et locaux de neige ou grésil",
    121: "Orages locaux de neige ou grésil",
    122: "Orages locaux de neige ou grésil",
    123: "Orages faibles de neige ou grésil",
    124: "Orages de neige ou grésil",
    125: "Orages de neige ou grésil",
    126: "Orages faibles et fréquents de neige ou grésil",
    127: "Orages fréquents de neige ou grésil",
    128: "Orages fréquents de neige ou grésil",
    130: "Orages faibles et locaux de pluie et neige mêlées ou grésil",
    131: "Orages locaux de pluie et neige mêlées ou grésil",
    132: "Orages fort et locaux de pluie et neige mêlées ou grésil",
    133: "Orages faibles de pluie et neige mêlées ou grésil",
    134: "Orages de pluie et neige mêlées ou grésil",
    135: "Orages forts de pluie et neige mêlées ou grésil",
    136: "Orages faibles et fréquents de pluie et neige mêlées ou grésil",
    137: "Orages fréquents de pluie et neige mêlées ou grésil",
    138: "Orages forts et fréquents de pluie et neige mêlées ou grésil",
    140: "Pluies orageuses",
    141: "Pluie et neige mêlées à caractère orageux",
    142: "Neige à caractère orageux",
    210: "Pluie faible intermittente",
    211: "Pluie modérée intermittente",
    212: "Pluie forte intermittente",
    220: "Neige faible intermittente",
    221: "Neige modérée intermittente",
    222: "Neige forte intermittente",
    230: "Pluie et neige mêlées",
    231: "Pluie et neige mêlées",
    232: "Pluie et neige mêlées",
    235: "Averses de grêle",
  };

  const icons = {
    0: "sun.ico",
    1: "peu_nuageux.ico",
    2: "sun_cloud_sm.ico",
    3: "peu_nuageux.ico",
    4: "fat_cloud.ico",
    5: "fat_cloud.ico",
    6: "fog.ico",
    7: "fog.ico",
    10: "light_rain_clouds_rain.ico",
    11: "rain_wather_cloud.ico",
    12: "fat_weather_showers.ico",
    13: "Pluie faible verglaçante",
    14: "Pluie modérée verglaçante",
    15: "Pluie forte verglaçante",
    16: "Bruine",
    20: "snow_cloud_sm.ico",
    21: "Neige modérée",
    22: "snow_cloud.ico",
    30: "Pluie et neige mêlées faibles",
    31: "Pluie et neige mêlées modérées",
    32: "Pluie et neige mêlées fortes",
    40: "weather_showers_cloud.ico",
    41: "fat_weather_showers.ico",
    42: "fat_weather_showers.ico",
    43: "weather_showers_cloud.ico",
    44: "fat_weather_showers.ico",
    45: "Averses de pluie fortes",
    46: "Averses de pluie faibles et fréquentes",
    47: "Averses de pluie fréquentes",
    48: "fat_weather_showers.ico",
    60: "Averses de neige localisées et faibles",
    61: "Averses de neige localisées",
    62: "Averses de neige localisées et fortes",
    63: "Averses de neige faibles",
    64: "Averses de neige",
    65: "Averses de neige fortes",
    66: "Averses de neige faibles et fréquentes",
    67: "Averses de neige fréquentes",
    68: "Averses de neige fortes et fréquentes",
    70: "Averses de pluie et neige mêlées localisées et faibles",
    71: "fat_weather_showers_snow.png",
    72: "big_fat_weather_showers_snow.png",
    73: "Averses de pluie et neige mêlées faibles",
    74: "Averses de pluie et neige mêlées",
    75: "Averses de pluie et neige mêlées fortes",
    76: "Averses de pluie et neige mêlées faibles et nombreuses",
    77: "fat_weather_showers_snow.png",
    78: "Averses de pluie et neige mêlées fortes et fréquentes",
    100: "Orages faibles et locaux",
    101: "lightning.ico",
    102: "Orages fort et locaux",
    103: "Orages faibles",
    104: "lightning.ico",
    105: "Orages forts",
    106: "litghtning_cloud_rain.ico", //
    107: "Orages fréquents",
    108: "litghtning_cloud_rain.ico",
    120: "Orages faibles et locaux de neige ou grésil",
    121: "Orages locaux de neige ou grésil",
    122: "Orages locaux de neige ou grésil",
    123: "Orages faibles de neige ou grésil",
    124: "Orages de neige ou grésil",
    125: "Orages de neige ou grésil",
    126: "Orages faibles et fréquents de neige ou grésil",
    127: "Orages fréquents de neige ou grésil",
    128: "Orages fréquents de neige ou grésil",
    130: "Orages faibles et locaux de pluie et neige mêlées ou grésil",
    131: "Orages locaux de pluie et neige mêlées ou grésil",
    132: "Orages fort et locaux de pluie et neige mêlées ou grésil",
    133: "Orages faibles de pluie et neige mêlées ou grésil",
    134: "Orages de pluie et neige mêlées ou grésil",
    135: "Orages forts de pluie et neige mêlées ou grésil",
    136: "Orages faibles et fréquents de pluie et neige mêlées ou grésil",
    137: "Orages fréquents de pluie et neige mêlées ou grésil",
    138: "Orages forts et fréquents de pluie et neige mêlées ou grésil",
    140: "Pluies orageuses",
    141: "Pluie et neige mêlées à caractère orageux",
    142: "Neige à caractère orageux",
    210: "light_rain_clouds_rain.ico",
    211: "rain_wather_cloud.ico",
    212: "fat_weather_showers.ico",
    220: "Neige faible intermittente",
    221: "Neige modérée intermittente",
    222: "Neige forte intermittente",
    230: "Pluie et neige mêlées",
    231: "Pluie et neige mêlées",
    232: "Pluie et neige mêlées",
    235: "Averses de grêle",
  };
  const WINDDIRS = [
    "Nord",
    "Nord-Nord-Est",
    "Nord-Est",
    "Est-Nord-Est",
    "Est",
    "Est-Sud-Est",
    "Sud-Est",
    "Sud-Sud-Est",
    "Sud",
    "Sud-Sud-Ouest",
    "Sud-Ouest",
    "Ouest-Sud-Ouest",
    "Ouest",
    "Ouest-Nord-Ouest",
    "Nord-Ouest",
    "Nord-Nord-Ouest",
    "Nord",
  ];
  this.get_winddir = function (deg) {
    return WINDDIRS[Math.floor((parseInt(deg) + 11.25) / 22.5)];
  };
  this.creeCarte = function (id, idname) {
    this.id1 = id;
    let de = document.getElementById(this.id1);
    let div1 = document.createElement("div");
    let card = document.createElement("div");
    let card_body = document.createElement("div");
    let div_proges = document.createElement("div");
    let titre = document.createElement("h4");
    titre.className = "header-title";
    titre.innerText = idname;
    card_body.id = idname;
    card_body.className = "card-body";
    card.className = "card";
    div1.className = "col-xl-4 col-lg-6 order-lg-3";
    card_body.appendChild(titre);
    card.appendChild(card_body);
    div1.appendChild(card);
    de.appendChild(div1);
  };
  this.creeData = function (id, data) {
    const idM = document.getElementById(id);
    const row = document.createElement("div");
    const div = document.createElement("div");
    const div1 = document.createElement("div");
    const img = document.createElement("img");
    const winddir = document.createElement("span");
    const status = document.createElement("span");
    const tempMax = document.createElement("span");
    const tempMin = document.createElement("span");
    const sunHours = document.createElement("span");
    const rain = document.createElement("span");

    img.src = `iconsMeteo/${icons[data.weather]}`;

    div.className = "col-sm-4";
    div1.className = "col-sm-8 row";
    winddir.className = "col-sm-12";
    status.className = "col-sm-12";
    tempMax.className = "col-sm-6";
    tempMin.className = "col-sm-6";
    sunHours.className = "col-sm-7";
    rain.className = "col-sm-12";

    row.className = "row";
    div.appendChild(img);
    status.innerText = `Status : ${WEATHER[data.weather]}`;
    winddir.innerText = `Vent : ${data.wind10m} km/h ${this.get_winddir(
      data.dirwind10m
    )}`;
    tempMin.innerHTML = `Temp min : ${data.tmin}°C`;
    tempMax.innerHTML = `Temp max : ${data.tmax}°C`;
    sunHours.innerHTML = `Ensoleillement : ${data.sun_hours}H`;
    rain.innerHTML = `Pluis : ${data.rr1}mm/J , Max ${data.rr10}mm/J`;
    div1.appendChild(status);
    div1.appendChild(tempMin);
    div1.appendChild(tempMax);
    div1.appendChild(sunHours);
    div1.appendChild(rain);
    div1.appendChild(winddir);
    row.appendChild(div);
    row.appendChild(div1);
    idM.appendChild(row);
  };
  this.MeteoAffiche = function (data) {
    const contenuData = data.forecast;
    this.info(data);
    for (let index = 0; index < contenuData.length; index++) {
      const element = contenuData[index];
      //console.log(element.datetime);
      const time = this.dateday(element.datetime);
      this.creeCarte("idmeteo", time);
      this.creeData(time, element);
    }
  };
  this.dateday = (datetime) => {
    const daytime = new Date(datetime);
    const time = `${jours[daytime.getDay()]} ${daytime.getDate()} ${
      Mois[daytime.getMonth()]
    }`;
    return time;
  };
  this.Update = function (data) {};
  this.info = function (data) {
    const ephemeride = data.ephemeride;
    const idTitle = document.getElementById("TitelMeteo");
    idTitle.innerHTML = "";
    const Title = document.createElement("H4");
    const row = document.createElement("div");
    const div = document.createElement("div");
    const div1 = document.createElement("div");
    const divSunDown = document.createElement("div");
    const divSunUp = document.createElement("div");
    const div3 = document.createElement("div");
    const div4 = document.createElement("div");
    const upsun = document.createElement("img");
    const downsun = document.createElement("img");
    const upspan = document.createElement("span");
    const downspan = document.createElement("span");
    const timeimg = document.createElement("img");
    const timespan = document.createElement("span");
    const lune = document.createElement("div");

    upsun.src = "iconsMeteo/sunrise_sun_up_sea.png";
    downsun.src = "iconsMeteo/sunset_sun_down_sea.png";
    row.className = "col-sm-12";
    row.appendChild(div);
    row.appendChild(div1);

    Title.innerText = `Ville: ${data.city.name}`;

    div.className = "col-sm-12";
    div.style = "text-align: center;";
    div.appendChild(Title);
    div1.className = "col-sm-12 row";

    divSunDown.className = "col-sm-3";
    divSunDown.style = "padding: 0px; margin-right: 7px;";
    downsun.style =
      "width: 25px !important;height: 25px !important; padding-right: 0px;margin-right: 5px;";
    //downsun.className = "col-sm-2"
    downspan.innerText = `${data.ephemeride.sunset}`;
    //downspan.className = "col-sm-3"
    downspan.style = "padding: 0px;";

    divSunUp.className = "col-sm-2";
    divSunUp.style = "padding: 0px;";
    upsun.style =
      "width: 25px !important;height: 25px !important;padding-right: 0px; margin-right: 5px;";
    //upsun.className = "col-sm-2"
    upspan.style = "padding: 0px; margin-top:4px;";
    upspan.innerText = `${data.ephemeride.sunrise}`;
    upspan.className = "col-sm-3";

    // divSunDown.appendChild(upsun)
    // divSunDown.appendChild(upspan)
    divSunUp.appendChild(upsun);
    divSunUp.appendChild(upspan);
    divSunDown.appendChild(downsun);
    divSunDown.appendChild(downspan);

    div3.className = "col-sm-2";
    div3.style = "padding: 0px;";
    timespan.innerText = `${data.ephemeride.diff_duration_day} min`;
    timespan.style = "margin-left:3px;";

    timeimg.src = "iconsMeteo/sunrise_sunset_day_sea_sun.png";
    timeimg.style = "width: 25px !important;height: 25px !important;";
    div3.appendChild(timeimg);
    div3.appendChild(timespan);
    div4.innerText = `Durée du jour: ${data.ephemeride.duration_day}`;
    lune.className = "col-sm-3";
    lune.innerText = `Lune: ${data.ephemeride.moon_phase}`;

    div1.appendChild(divSunUp);
    div1.appendChild(divSunDown);
    div1.appendChild(div3);
    div1.appendChild(div4);
    div1.appendChild(lune);
    idTitle.appendChild(row);
  };
}
